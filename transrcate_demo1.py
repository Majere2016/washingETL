#!/usr/bin/env python3# -*- coding: utf-8 -*-"""Created on 2017/6/8 下午6:43@author: zhechengma"""import pymysqlimport pandas as pdimport numpyfrom pandas import Series , DataFrameimport reconn = pymysql.connect ( host = '192.168.20.145' , port = 3306 , user = 'root' , password = '123456' ,                         db = 'network' , charset = 'utf8' )df1 = pd.read_sql ( "select * from c_base_info where addtime > '2017-07-05 00:00:00'", conn )del df1 [ 'id' ] , df1 [ 'cid' ] , df1 [ 'addtime' ] , df1 [ 'code' ] , df1 [ 'updatetime' ]a = [ ]for i in df1 [ 'corporation' ] :	i = str ( i ).replace ( ' ' , '' )	i = i.replace ( '-' , '' )	i = i.strip ( )	a.append ( i )df1 [ 'corporation' ] = pd.Series ( a )def repalce_data ( dataseries ) :	a = [ ]	for i in dataseries :		i = str ( i ).replace ( ' ' , '' )		i = i.replace ( '-' , '' )		i = i.strip ( )		a.append ( i )	return aaxiba = repalce_data ( df1 [ 'credit_code' ] )df1 [ 'credit_code' ] = axibacolunms_name = list ( df1.keys ( ) )print ( list ( colunms_name ) )for i in colunms_name :	axiba = repalce_data ( df1 [ i ] )	df1 [ i ] = pd.Series ( axiba )b = [ ]for i in df1 [ 'creation_date' ] :	if len (i) == 8 :		i = i [ 0 :4 ] + '-' + i [ 4 :6 ] + '-' + i [ 6 : ]	else :		i = '0000-00-00'	b.append ( i )df1 [ 'creation_date' ] = pd.Series ( b )def change_datetime ( dataseries ) :	b = [ ]	for i in dataseries :		if len ( i ) == 8 :			i = i [ 0 :4 ] + '-' + i [ 4 :6 ] + '-' + i [ 6 : ]		else :			i = '0000-00-00'		b.append ( i )	return bdatetime_list = [ 'approved_date' , 'sdate' , 'edate' ]for i in datetime_list :	ajiba = change_datetime ( df1 [ i ] )	df1 [ i ] = pd.Series ( ajiba )a = [ ]b = [ ]for i in df1 [ 'capital' ] :	cap_list = str ( i ).split ( '万' )	if len ( cap_list ) > 1 :		capital = cap_list [ 0 ]		types = cap_list [ 1 ]	a.append ( capital )	b.append ( types )df1 [ 'capital' ] = pd.Series ( a )df1 [ 'capital_type' ] = pd.Series ( b )a = [ ]for i in df1 [ 'state' ] :	if '存续' in i :		i = 1	elif '吊销' in i :		i = 3	elif '在业' in i :		i = 1	elif '注销' in i :		i = 2	else :		i = 1	a.append ( i )df1 [ 'state' ] = pd.Series ( a )a = [ ]for i in df1 [ 'capital_type' ] :	if '元' in i :		i = 1	elif '元人民币' in i :		i = 1	elif '人民币' in i :		i = 1	elif '美元' in i :		i = 2	elif '港币' in i :		i = 3	else :		i = 0	a.append ( i )df1 [ 'capital_type' ] = pd.Series ( a )from sqlalchemy import create_engineyconnect = create_engine ( 'mysql+pymysql://miqixin_mo:miqixin_mo8812345@192.168.20.173:3310/miqixin?charset=utf8' )df1 = df1.drop_duplicates ( )try :	df1.to_sql ( 'c_base' , con = yconnect , if_exists = 'append' , index = False )except Exception as ee :	print ( ee )	passdf1.to_csv ( "C:\Users\Administrator\Desktop\washingdata\c_base.csv" )